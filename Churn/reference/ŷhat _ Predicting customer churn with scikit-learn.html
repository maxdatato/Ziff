<!DOCTYPE html>
<!-- saved from url=(0070)http://blog.yhat.com/posts/predicting-customer-churn-with-sklearn.html -->
<html class="js wf-ffdaxwebpro-i7-active wf-ffdaxwebpro-i4-active wf-ffdaxwebpro-n4-active wf-ffdaxwebpro-n7-active wf-raleway-n7-active wf-raleway-n4-active wf-raleway-n3-active wf-raleway-n6-active wf-hellenicwide-n4-active wf-active"><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>ŷhat | Predicting customer churn with scikit-learn</title>

        <meta name="description" content="Using machine learning to predict which customers are likely to churn.">
        <meta name="&lt;meta" content="width=device-width, initial-scale=1.0">
        <link href="http://blog.yhat.com/static/favicon.ico" rel="shortcut icon">
        

        

<meta name="description" content="predicting customer churn with scikit learn and yhat by eric chiang">
<meta name="keywords" content="yhat, yhathq, yhat inc, churn rate, customer churn, churn, retention, predictive model, predictive analytics, machine learning, random forest, support vector, eric chiang, data science, customer retention, attrition, customer attrition, deploy, model, operations, retention team">


        <!-- facebook open graph tags -->
<meta property="og:title" content="ŷhat | Predicting customer churn with scikit-learn">
<meta property="og:type" content="website">
<meta property="og:url" content="http://blog.yhat.com/posts/predicting-customer-churn-with-sklearn.html">
<meta property="og:image" content="http://blog.yhat.com/static/img/headline/netflix.png">
<meta property="og:site_name" content="ŷhat | Blog">
<meta property="fb:admins" content="1018260045">
<meta property="og:description" content="


Customer Churn
&quot;Churn Rate&quot; is a business term describing the rate at which customers leave or cease paying for a product or service. It&#39;s a critical figure in many businesses, as it&#39;s often the case that acquiring new customers is a lot more costly than retaining existing ones (in some cases, 5 to 20 times more expensive).
Understanding what keeps customers engaged, therefore, is incredibly valuable, as it is a logical foundation from which to develop retention strategies ...">

<!-- twitter -->
<meta property="twitter:account_id" content="1081568149">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="@yhathq">
<meta name="twitter:title" content="ŷhat | Predicting customer churn with scikit-learn">
<meta name="twitter:description" content="


Customer Churn
&quot;Churn Rate&quot; is a business term describing the rate at which customers leave or cease paying for a product or service. It&#39;s a critical figure in many businesses, as it&#39;s often the case that acquiring new customers is a lot more costly than retaining existing ones (in some cases, 5 to 20 times more expensive).
Understanding what keeps customers engaged, therefore, is incredibly valuable, as it is a logical foundation from which to develop retention strategies ...">
<meta name="twitter:creator" content="@yhathq">
<meta name="twitter:image:src" content="http://blog.yhat.com/static/img/headline/netflix.png">
<meta name="twitter:domain" content="yhat.com">


        <link href="./ŷhat _ Predicting customer churn with scikit-learn_files/css" rel="stylesheet" type="text/css">
        <link href="./ŷhat _ Predicting customer churn with scikit-learn_files/yhat-blog.css" rel="stylesheet">

        <script async="" src="./ŷhat _ Predicting customer churn with scikit-learn_files/analytics.js.download"></script><script type="text/javascript" src="./ŷhat _ Predicting customer churn with scikit-learn_files/enh8ddt.js.download"></script>
        <style type="text/css">.tk-ff-dax-web-pro{font-family:"ff-dax-web-pro",sans-serif;}.tk-raleway{font-family:"raleway",sans-serif;}.tk-hellenic-wide{font-family:"hellenic-wide",sans-serif;}</style><style type="text/css">@font-face{font-family:tk-ff-dax-web-pro-i7;src:url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff2"),url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff"),url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("opentype");font-weight:700;font-style:italic;}@font-face{font-family:tk-ff-dax-web-pro-i4;src:url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff2"),url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff"),url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;}@font-face{font-family:tk-ff-dax-web-pro-n4;src:url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:tk-ff-dax-web-pro-n7;src:url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;}@font-face{font-family:tk-raleway-n7;src:url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;}@font-face{font-family:tk-raleway-n4;src:url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:tk-raleway-n3;src:url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff2"),url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff"),url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("opentype");font-weight:300;font-style:normal;}@font-face{font-family:tk-raleway-n6;src:url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff2"),url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff"),url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("opentype");font-weight:600;font-style:normal;}@font-face{font-family:tk-hellenic-wide-n4;src:url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}</style><script type="text/javascript">try{Typekit.load({ async: true });}catch(e){}</script>

        <script src="./ŷhat _ Predicting customer churn with scikit-learn_files/modernizr.js.download"></script>

        <!-- start Optimizely --><script src="./ŷhat _ Predicting customer churn with scikit-learn_files/394671342.js.download"></script><!-- end Optimizely -->

    <style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">@font-face{font-family:ff-dax-web-pro;src:url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff2"),url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("woff"),url(https://use.typekit.net/af/5fdd20/000000000000000000015e29/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i7&v=3) format("opentype");font-weight:700;font-style:italic;}@font-face{font-family:ff-dax-web-pro;src:url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff2"),url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("woff"),url(https://use.typekit.net/af/fc555b/0000000000000000000173c8/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=i4&v=3) format("opentype");font-weight:400;font-style:italic;}@font-face{font-family:ff-dax-web-pro;src:url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/51efec/000000000000000000015e49/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:ff-dax-web-pro;src:url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/c5bae8/000000000000000000015e28/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;}@font-face{font-family:raleway;src:url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff2"),url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("woff"),url(https://use.typekit.net/af/f6e2e6/000000000000000000013287/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n7&v=3) format("opentype");font-weight:700;font-style:normal;}@font-face{font-family:raleway;src:url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/a4ebe0/000000000000000000013288/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}@font-face{font-family:raleway;src:url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff2"),url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("woff"),url(https://use.typekit.net/af/2ced59/00000000000000000001328a/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n3&v=3) format("opentype");font-weight:300;font-style:normal;}@font-face{font-family:raleway;src:url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff2"),url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("woff"),url(https://use.typekit.net/af/f7318b/000000000000000000014968/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n6&v=3) format("opentype");font-weight:600;font-style:normal;}@font-face{font-family:hellenic-wide;src:url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/l?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff2"),url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/d?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("woff"),url(https://use.typekit.net/af/97a712/00000000000000000000dfb9/27/a?primer=7cdcb44be4a7db8877ffa5c0007b8dd865b3bbc383831fe2ea177f62257a9191&fvd=n4&v=3) format("opentype");font-weight:400;font-style:normal;}</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style id="style-1-cropbar-clipper">/* Copyright 2014 Evernote Corporation. All rights reserved. */
.en-markup-crop-options {
    top: 18px !important;
    left: 50% !important;
    margin-left: -100px !important;
    width: 200px !important;
    border: 2px rgba(255,255,255,.38) solid !important;
    border-radius: 4px !important;
}

.en-markup-crop-options div div:first-of-type {
    margin-left: 0px !important;
}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
    <body style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
        <header style="margin-bottom:0px;">
    <div class="container">
        <a href="https://www.yhat.com/">
            <img style="height:3em; font-size:18px;" src="./ŷhat _ Predicting customer churn with scikit-learn_files/yhat-logo-transparent.png">
        </a>
        <nav class="navbar navbar-custom navbar-transparent navbar-fixed-top" style="display: block;">
            <ul class="header-menu menu" style="float:right;">
                <li><a id="header-blog" href="https://www.yhat.com/products/bandit">Bandit<sup><span style="background-color:#428bca; color:white;font-size:12px;">Beta</span></sup></a></li>
                <li><a id="header-blog" href="https://www.yhat.com/products/rodeo">Rodeo<sup><span style="background-color:#428bca; color:white;font-size:12px;">New</span></sup></a></li>
                <li><a id="header-blog" href="https://www.yhat.com/products/scienceops">ScienceOps</a></li>
                <li><a id="header-blog" href="https://www.yhat.com/about">Company</a></li>
            </ul>
            <a id="mobile-menu-trigger" class="visible-xs"><span class="icon icon-menu"></span></a>
        </nav>
    </div>
</header>

        <!--  -->

        <div class="main" style="margin-bottom: 211px;">
            
<section class="pagination center-text top">
  <div class="hero">
    <h1 class="head"><a href="http://blog.yhat.com/">The Yhat Blog</a></h1>
    <br>
    <p style="color: white;">machine learning, data science, engineering</p>
    <br>
    <form class="form-inline text-center subscribe-form" role="form" style="margin:0% 25%">
      <div class="form-group">
        <input type="email" value="" name="EMAIL" class="form-control required email" placeholder="Email Address" required="">
      </div>
      <button class="btn" type="submit">Get Updates</button>
    </form>
  </div>
</section>
<section>
  <div id="page-wrap" class="container-fluid" style="max-width:none;">
    <div id="floating-sidebar">
      
<a class="resp-sharing-button__link" href="https://www.yhat.com/" target="_blank">
  <div class="resp-sharing-button resp-sharing-button--yhat resp-sharing-button--large" style="height: 30px; line-height: 1.9;"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
  </div>Learn More</div>
</a>

<!-- Sharingbutton Facebook -->

<a class="facebook-share resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html" target="_blank" aria-label="Facebook">
  <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
      <g>
        <path d="M18.768,7.465H14.5V5.56c0-0.896,0.594-1.105,1.012-1.105s2.988,0,2.988,0V0.513L14.171,0.5C10.244,0.5,9.5,3.438,9.5,5.32 v2.145h-3v4h3c0,5.212,0,12,0,12h5c0,0,0-6.85,0-12h3.851L18.768,7.465z"></path>
      </g>
    </svg>
  </div>Facebook</div>
</a>

<!-- Sharingbutton Twitter -->
<a class="twitter-share resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Predicting%20customer%20churn%20with%20scikit-learn&amp;url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;via=YhatHQ" target="_blank" aria-label="Twitter">
  <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
      <g>
        <path d="M23.444,4.834c-0.814,0.363-1.5,0.375-2.228,0.016c0.938-0.562,0.981-0.957,1.32-2.019c-0.878,0.521-1.851,0.9-2.886,1.104 C18.823,3.053,17.642,2.5,16.335,2.5c-2.51,0-4.544,2.036-4.544,4.544c0,0.356,0.04,0.703,0.117,1.036 C8.132,7.891,4.783,6.082,2.542,3.332C2.151,4.003,1.927,4.784,1.927,5.617c0,1.577,0.803,2.967,2.021,3.782 C3.203,9.375,2.503,9.171,1.891,8.831C1.89,8.85,1.89,8.868,1.89,8.888c0,2.202,1.566,4.038,3.646,4.456 c-0.666,0.181-1.368,0.209-2.053,0.079c0.579,1.804,2.257,3.118,4.245,3.155C5.783,18.102,3.372,18.737,1,18.459 C3.012,19.748,5.399,20.5,7.966,20.5c8.358,0,12.928-6.924,12.928-12.929c0-0.198-0.003-0.393-0.012-0.588 C21.769,6.343,22.835,5.746,23.444,4.834z"></path>
      </g>
    </svg>
  </div>Twitter</div>
</a>

<!-- Sharingbutton Linkedin -->
<a class="linkedin-share resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;title=Predicting%20customer%20churn%20with%20scikit-learn&amp;summary=Using%20machine%20learning%20to%20predict%20which%20customers%20are%20likely%20to%20churn.&amp;source=Yhat;" target="_blank" aria-label="Linkedin">
  <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
      <g>
        <path d="M6.527,21.5h-5v-13h5V21.5z M4.018,6.5H3.988C2.478,6.5,1.5,5.318,1.5,4.019c0-1.329,1.008-2.412,2.547-2.412 c1.541,0,2.488,1.118,2.519,2.447C6.565,5.354,5.588,6.5,4.018,6.5z M15.527,12.5c-1.105,0-2,0.896-2,2v7h-5c0,0,0.059-12,0-13h5 v1.485c0,0,1.548-1.443,3.938-1.443c2.962,0,5.062,2.144,5.062,6.304V21.5h-5v-7C17.527,13.396,16.632,12.5,15.527,12.5z"></path>
      </g>
    </svg>
  </div>Linkedin</div>
</a>

<!-- Sharingbutton Reddit -->
<a class="reddit-share resp-sharing-button__link" href="https://reddit.com/submit/?url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;title=Predicting%20customer%20churn%20with%20scikit-learn" target="_blank" aria-label="Reddit">
  <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
    <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
      <path d="M24,11.5c0-1.654-1.346-3-3-3c-0.964,0-1.863,0.476-2.422,1.241c-1.639-1.006-3.747-1.64-6.064-1.723 c0.064-1.11,0.4-3.049,1.508-3.686c0.72-0.414,1.733-0.249,3.01,0.478C17.189,6.317,18.452,7.5,20,7.5c1.654,0,3-1.346,3-3 s-1.346-3-3-3c-1.382,0-2.536,0.944-2.883,2.217C15.688,3,14.479,2.915,13.521,3.466c-1.642,0.945-1.951,3.477-2.008,4.551 C9.186,8.096,7.067,8.731,5.422,9.741C4.863,8.976,3.964,8.5,3,8.5c-1.654,0-3,1.346-3,3c0,1.319,0.836,2.443,2.047,2.844 C2.019,14.56,2,14.778,2,15c0,3.86,4.486,7,10,7s10-3.14,10-7c0-0.222-0.019-0.441-0.048-0.658C23.148,13.938,24,12.795,24,11.5z  M2.286,13.366C1.522,13.077,1,12.351,1,11.5c0-1.103,0.897-2,2-2c0.635,0,1.217,0.318,1.59,0.816 C3.488,11.17,2.683,12.211,2.286,13.366z M6,13.5c0-1.103,0.897-2,2-2s2,0.897,2,2c0,1.103-0.897,2-2,2S6,14.603,6,13.5z  M15.787,18.314c-1.063,0.612-2.407,0.949-3.787,0.949c-1.387,0-2.737-0.34-3.803-0.958c-0.239-0.139-0.321-0.444-0.182-0.683 c0.139-0.24,0.444-0.322,0.683-0.182c1.828,1.059,4.758,1.062,6.59,0.008c0.239-0.138,0.545-0.055,0.683,0.184 C16.108,17.871,16.026,18.177,15.787,18.314z M16,15.5c-1.103,0-2-0.897-2-2c0-1.103,0.897-2,2-2s2,0.897,2,2 C18,14.603,17.103,15.5,16,15.5z M21.713,13.365c-0.397-1.155-1.201-2.195-2.303-3.048C19.784,9.818,20.366,9.5,21,9.5 c1.103,0,2,0.897,2,2C23,12.335,22.468,13.073,21.713,13.365z"></path>
    </svg>
  </div>Reddit</div>
</a>



    </div>
    <div class="row" style="margin: 0% 5%;">
      <article class="col-sm-offset-1 col-md-8">
        <div class="row">
          <header class="article-header" style="position: relative; max-height: initial; text-align:left;">
            <h1 id="post-title">Predicting customer churn with scikit-learn</h1>
            <h4 style="display:inline-block">by <a href="https://twitter.com/erchiang" target="_blank"> Eric Chiang </a> | <time class="time" pubdate="pubdate">March 20, 2014</time></h4>
          </header>
          <hr>
        </div>
        <div class="row">
          

<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="customer-churn">Customer Churn</h3>
<p>"<a href="http://en.wikipedia.org/wiki/Churn_rate?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="churn rate on wikipedia" target="_blank">Churn Rate</a>" is a business term describing the rate at which customers leave or cease paying for a product or service. It's a critical figure in many businesses, as it's often the case that acquiring <i>new</i> customers is a lot more costly than retaining <i>existing</i> ones (in some cases, <a href="http://www.camfoundation.com/PDF/Cost-of-customer-acquisition-vs-customer-retention.pdf?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="customer acquisition vs customer retention" target="_blank">5 to 20 times</a> more expensive).</p>
<p>Understanding what keeps customers engaged, therefore, is incredibly valuable, as it is a logical foundation from which to develop retention strategies and roll out operational practices aimed to keep customers from walking out the door. Consequently, there's growing interest among companies to develop better churn-detection techniques, leading many to look to data mining and machine learning for new and creative approaches.</p>
<p>Predicting churn is particularly important for businesses w/ subscription models such as cell phone, cable, or merchant credit card processing plans. But modeling churn has wide reaching applications in many domains. For example, casinos have used predictive models to predict <a href="http://www.academia.edu/2467733/Predictive_Analytics_in_the_Gaming_Industry?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="Predictive Analytics in the Gaming Industry" target="_blank">ideal room conditions</a> for keeping patrons at the blackjack table and when to reward <a href="http://www.npr.org/blogs/money/2011/11/15/142366953/the-tuesday-podcast-from-harvard-economist-to-casino-ceo?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="podcast from harvard economist to casino ceo" target="_blank">unlucky gamblers</a> with front row seats to Celine Dion. Similarly, airlines may offer first class upgrades to complaining customers. The list goes on.</p>
<p>This is a post about modeling customer churn using Python.</p>
<hr>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="customer-churn">Wait, don't go!</h4>
<p>So what are some of ops strategies that companies employ to prevent churn? Well, reducing churn, it turns out, often requires non-trivial resources. Specialized retention teams are common in many industries and exist expressly to call down lists of at-risk customers to plead for their continued business.</p>
<img src="./ŷhat _ Predicting customer churn with scikit-learn_files/netflix.png">
<p>Organizing and running such teams is tough. From an ops perspective, cross-geographic teams must be well organized and trained to respond to a huge spectrum of customer complaints. Customers must be accurately targeted based on churn-risk, and retention treatments must be well-conceived and correspond reasonably to match expected customer value to ensure the economics make sense. Spending <span>$</span>1,000 on someone who wasn't about to leave can get expensive pretty quickly.</p>
<p>The good news is that we live in the data age and have some pretty great tools at our disposal to help answer these questions. <a href="http://www.john-foreman.com/?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="John Foreman, Data Scientist &amp; Cool Dude." target="_blank">John Forman</a> of <a href="http://mailchimp.com/?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="Send Better Email | MailChimp" target="_blank">MailChimp</a> summarizes this well:</p>
<blockquote>
<p>"I work in the e-mail marketing industry for a website called MailChimp.com. We help customers send e-mail newsletters to their audience, and every time someone uses the term 'e-mail blast,' a little part of me dies.</p>
<p>"Why? Because e-mail addresses are no longer black boxes that you lob 'blasts' at like flash grenades. No, in e-mail marketing (as with many other forms of online engagement, including tweets, Facebook posts, and Pinterest campaigns), a business receives feedback on how their audience is engaging at the individual level through click tracking, online purchases, social sharing, and so on. This data is not noise. It characterizes your audience. But to the uninitiated, it might as well be Greek. Or <a href="http://en.wikipedia.org/wiki/Esperanto?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" title="Esperanto on wikipedia" target="_blank">Esperanto</a>."</p>
<sub>- John Foreman, <a href="http://www.amazon.com/Data-Smart-Science-Transform-Information/dp/111866146X?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" target="_blank"><em>DataSmart</em></a></sub>
</blockquote>
<p>Within this frame of mind, efficiently dealing with turnover is an exercise of distinguishing who is likely to churn from who is not using the data at our disposal. The remainder of this post will explore a simple case study to show how Python and its scientific libraries can be used to predict churn and how you might deploy such a solution within operations to guide a retention team.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="the-dataset">The Dataset</h3>
<p>The data set I'll be using is a longstanding telecom customer data set which you can download <a href="https://raw.githubusercontent.com/EricChiang/churn/master/data/churn.csv" target="_blank">here</a>.</p>
<p>The data is straightforward. Each row represents a subscribing telephone customer. Each column contains customer attributes such as phone number, call minutes used during different times of day, charges incurred for services, lifetime account duration, and whether or not the customer is still a customer.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[2]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">__future__</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">division</span></span><span class="pln">
</span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="nn"><span class="pln">pandas</span></span><span class="pln"> </span><span class="kn"><span class="kwd">as</span></span><span class="pln"> </span><span class="nn"><span class="pln">pd</span></span><span class="pln">
</span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="nn"><span class="pln">numpy</span></span><span class="pln"> </span><span class="kn"><span class="kwd">as</span></span><span class="pln"> </span><span class="nn"><span class="pln">np</span></span><span class="pln">

</span><span class="n"><span class="pln">churn_df</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">read_csv</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">'churn.csv'</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">col_names</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_df</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">columns</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">tolist</span></span><span class="p"><span class="pun">()</span></span><span class="pln">

</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Column names:"</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="n"><span class="pln">col_names</span></span><span class="pln">

</span><span class="n"><span class="pln">to_show</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">col_names</span></span><span class="p"><span class="pun">[:</span></span><span class="mi"><span class="lit">6</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> </span><span class="n"><span class="pln">col_names</span></span><span class="p"><span class="pun">[</span></span><span class="o"><span class="pun">-</span></span><span class="mi"><span class="lit">6</span></span><span class="p"><span class="pun">:]</span></span><span class="pln">

</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"</span></span><span class="se"><span class="str">\n</span></span><span class="s"><span class="str">Sample data:"</span></span><span class="pln">
</span><span class="n"><span class="pln">churn_df</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">to_show</span></span><span class="p"><span class="pun">]</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">head</span></span><span class="p"><span class="pun">(</span></span><span class="mi"><span class="lit">6</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
      </span></pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="prettyprint prettyprinted"><span class="pln">          </span><span class="typ">Column</span><span class="pln"> names</span><span class="pun">:</span><span class="pln">
          </span><span class="pun">[</span><span class="str">'State'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Account Length'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Area Code'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Phone'</span><span class="pun">,</span><span class="pln"> </span><span class="str">"Int'l Plan"</span><span class="pun">,</span><span class="pln"> </span><span class="str">'VMail Plan'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'VMail Message'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Day Mins'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Day Calls'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Day Charge'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Eve Mins'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Eve Calls'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Eve Charge'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Night Mins'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Night Calls'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Night Charge'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Intl Mins'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Intl Calls'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Intl Charge'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'CustServ Calls'</span><span class="pun">,</span><span class="pln"> </span><span class="str">'Churn?'</span><span class="pun">]</span><span class="pln">

          </span><span class="typ">Sample</span><span class="pln"> data</span><span class="pun">:</span><span class="pln">

        </span></pre>
</div>
</div>
<div class="hbox row output_area"><div class="prompt output_prompt col-sm-1">
      Out[2]:</div>
<div class="box-flex1 output_subarea output_pyout col-sm-11">
<div class="output_html rendered_html">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>State</th>
<th>Account Length</th>
<th>Area Code</th>
<th>Phone</th>
<th>Int'l Plan</th>
<th>VMail Plan</th>
<th>Night Charge</th>
<th>Intl Mins</th>
<th>Intl Calls</th>
<th>Intl Charge</th>
<th>CustServ Calls</th>
<th>Churn?</th>
</tr>
</thead>
<tbody>
<tr>
<th>0</th>
<td> KS</td>
<td> 128</td>
<td> 415</td>
<td> 382-4657</td>
<td>  no</td>
<td> yes</td>
<td> 11.01</td>
<td> 10.0</td>
<td> 3</td>
<td> 2.70</td>
<td> 1</td>
<td> False.</td>
</tr>
<tr>
<th>1</th>
<td> OH</td>
<td> 107</td>
<td> 415</td>
<td> 371-7191</td>
<td>  no</td>
<td> yes</td>
<td> 11.45</td>
<td> 13.7</td>
<td> 3</td>
<td> 3.70</td>
<td> 1</td>
<td> False.</td>
</tr>
<tr>
<th>2</th>
<td> NJ</td>
<td> 137</td>
<td> 415</td>
<td> 358-1921</td>
<td>  no</td>
<td>  no</td>
<td>  7.32</td>
<td> 12.2</td>
<td> 5</td>
<td> 3.29</td>
<td> 0</td>
<td> False.</td>
</tr>
<tr>
<th>3</th>
<td> OH</td>
<td>  84</td>
<td> 408</td>
<td> 375-9999</td>
<td> yes</td>
<td>  no</td>
<td>  8.86</td>
<td>  6.6</td>
<td> 7</td>
<td> 1.78</td>
<td> 2</td>
<td> False.</td>
</tr>
<tr>
<th>4</th>
<td> OK</td>
<td>  75</td>
<td> 415</td>
<td> 330-6626</td>
<td> yes</td>
<td>  no</td>
<td>  8.41</td>
<td> 10.1</td>
<td> 3</td>
<td> 2.73</td>
<td> 3</td>
<td> False.</td>
</tr>
<tr>
<th>5</th>
<td> AL</td>
<td> 118</td>
<td> 510</td>
<td> 391-8027</td>
<td> yes</td>
<td>  no</td>
<td>  9.18</td>
<td>  6.3</td>
<td> 6</td>
<td> 1.70</td>
<td> 0</td>
<td> False.</td>
</tr>
</tbody>
</table>
<p>6 rows × 12 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>I'll be keeping the statistical model pretty simple for this blog so the feature space is almost unchanged from what you see above. The following code simply drops irrelevant columns and converts strings to boolean values (since models don't handle "yes" and "no" very well). The rest of the numeric columns are left untouched.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[3]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="c"><span class="com"># Isolate target data</span></span><span class="pln">
</span><span class="n"><span class="pln">churn_result</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_df</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'Churn?'</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">y</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="kwd">where</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">churn_result</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="s"><span class="str">'True.'</span></span><span class="p"><span class="pun">,</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">,</span></span><span class="mi"><span class="lit">0</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># We don't need these columns</span></span><span class="pln">
</span><span class="n"><span class="pln">to_drop</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'State'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Area Code'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Phone'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Churn?'</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">churn_feat_space</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_df</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">drop</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">to_drop</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">axis</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># 'yes'/'no' has to be converted to boolean values</span></span><span class="pln">
</span><span class="c"><span class="com"># NumPy converts these from boolean to 1. and 0. later</span></span><span class="pln">
</span><span class="n"><span class="pln">yes_no_cols</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">"Int'l Plan"</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">"VMail Plan"</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">churn_feat_space</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">yes_no_cols</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_feat_space</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">yes_no_cols</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="s"><span class="str">'yes'</span></span><span class="pln">

</span><span class="c"><span class="com"># Pull out features for future use</span></span><span class="pln">
</span><span class="n"><span class="pln">features</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_feat_space</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">columns</span></span><span class="pln">

</span><span class="n"><span class="pln">X</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_feat_space</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">as_matrix</span></span><span class="p"><span class="pun">()</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">astype</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="kwd">float</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># This is important</span></span><span class="pln">
</span><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">preprocessing</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="typ">StandardScaler</span></span><span class="pln">
</span><span class="n"><span class="pln">scaler</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="typ">StandardScaler</span></span><span class="p"><span class="pun">()</span></span><span class="pln">
</span><span class="n"><span class="pln">X</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">scaler</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">fit_transform</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Feature space holds </span></span><span class="si"><span class="str">%d</span></span><span class="s"><span class="str"> observations and </span></span><span class="si"><span class="str">%d</span></span><span class="s"><span class="str"> features"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="n"><span class="pln">X</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">shape</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Unique target labels:"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">unique</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
      </span></pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="prettyprint prettyprinted"><span class="pln">          </span><span class="typ">Feature</span><span class="pln"> space holds </span><span class="lit">3333</span><span class="pln"> observations </span><span class="kwd">and</span><span class="pln"> </span><span class="lit">17</span><span class="pln"> features
          </span><span class="typ">Unique</span><span class="pln"> target labels</span><span class="pun">:</span><span class="pln"> </span><span class="pun">[</span><span class="lit">0</span><span class="pln"> </span><span class="lit">1</span><span class="pun">]</span><span class="pln">

        </span></pre>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>One slight side note. Many <a href="http://blog.yhathq.com/posts/classification-using-knn-and-python.html?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" target="_blank">predictors</a> care about the relative size of different features even though those scales might be arbitrary. For instance: the number of points a basketball team scores per game will naturally be a couple orders of magnitude larger than their win percentage. But this doesn't mean that the latter is 100 times less significant. <code>StandardScaler</code> fixes this by normalizing each feature to a range of around 1.0 to -1.0 thereby preventing models from misbehaving. Well, at least for that reason.</p>
<p>Great, I now have a feature space '<code>X</code>' and a set of target values '<code>y</code>'. On to the predictions!</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="how-good-is-your-model">How good is your model?</h3>
<p>Express, test, cycle. A machine learning pipeline should be anything but static. There are always new features to design, new data to use, new classifiers to consider each with unique parameters to tune. And for every change it's critical to be able to ask, <em>"Is the new version better than the last?"</em> So how do I do that?</p>
<p>As a good start, cross validation will be used throughout this blog. Cross validation attempts to avoid overfitting (training on and predicting the same datapoint) while still producing a prediction for each observation dataset. This is accomplished by systematically hiding different subsets of the data while training a set of models. After training, each model predicts on the subset that had been hidden to it, emulating multiple train-test splits. When done correctly, every observation will have a 'fair' corresponding prediction.</p>
<p>Here's what that looks like using <code>scikit-learn</code> libraries.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[4]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">cross_validation</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="typ">KFold</span></span><span class="pln">

</span><span class="k"><span class="kwd">def</span></span><span class="pln"> </span><span class="nf"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">clf_class</span></span><span class="p"><span class="pun">,</span></span><span class="o"><span class="pun">**</span></span><span class="n"><span class="pln">kwargs</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
    </span><span class="c"><span class="com"># Construct a kfolds object</span></span><span class="pln">
    </span><span class="n"><span class="pln">kf</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="typ">KFold</span></span><span class="p"><span class="pun">(</span></span><span class="nb"><span class="pln">len</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">),</span></span><span class="n"><span class="pln">n_folds</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">5</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">shuffle</span></span><span class="o"><span class="pun">=</span></span><span class="bp"><span class="kwd">True</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
    </span><span class="n"><span class="pln">y_pred</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">y</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">copy</span></span><span class="p"><span class="pun">()</span></span><span class="pln">

    </span><span class="c"><span class="com"># Iterate through folds</span></span><span class="pln">
    </span><span class="k"><span class="kwd">for</span></span><span class="pln"> </span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">test_index</span></span><span class="pln"> </span><span class="ow"><span class="kwd">in</span></span><span class="pln"> </span><span class="n"><span class="pln">kf</span></span><span class="p"><span class="pun">:</span></span><span class="pln">
        </span><span class="n"><span class="pln">X_train</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">X_test</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">],</span></span><span class="pln"> </span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">test_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="n"><span class="pln">y_train</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="c"><span class="com"># Initialize a classifier with key word arguments</span></span><span class="pln">
        </span><span class="n"><span class="pln">clf</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">clf_class</span></span><span class="p"><span class="pun">(</span></span><span class="o"><span class="pun">**</span></span><span class="n"><span class="pln">kwargs</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">fit</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X_train</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y_train</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="n"><span class="pln">y_pred</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">test_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">predict</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X_test</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
    </span><span class="k"><span class="kwd">return</span></span><span class="pln"> </span><span class="n"><span class="pln">y_pred</span></span></pre></div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>I've decided to compare three fairly unique algorithms support vector machines, random forest, and k-nearest-neighbors. Nothing fancy here, just passing each to cross validation and determining how often the classifier predicted the correct class.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[5]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">svm</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">SVC</span></span><span class="pln">
</span><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">ensemble</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="typ">RandomForestClassifier</span></span><span class="pln"> </span><span class="k"><span class="kwd">as</span></span><span class="pln"> </span><span class="n"><span class="pln">RF</span></span><span class="pln">
</span><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">neighbors</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="typ">KNeighborsClassifier</span></span><span class="pln"> </span><span class="k"><span class="kwd">as</span></span><span class="pln"> </span><span class="n"><span class="pln">KNN</span></span><span class="pln">

</span><span class="k"><span class="kwd">def</span></span><span class="pln"> </span><span class="nf"><span class="pln">accuracy</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y_true</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y_pred</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
    </span><span class="c"><span class="com"># NumPy interprets True and False as 1. and 0.</span></span><span class="pln">
    </span><span class="k"><span class="kwd">return</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">mean</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y_true</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="n"><span class="pln">y_pred</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Support vector machines:"</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"</span></span><span class="si"><span class="str">%.3f</span></span><span class="s"><span class="str">"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="n"><span class="pln">accuracy</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">SVC</span></span><span class="p"><span class="pun">))</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Random forest:"</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"</span></span><span class="si"><span class="str">%.3f</span></span><span class="s"><span class="str">"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="n"><span class="pln">accuracy</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">RF</span></span><span class="p"><span class="pun">))</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"K-nearest-neighbors:"</span></span><span class="pln">
</span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"</span></span><span class="si"><span class="str">%.3f</span></span><span class="s"><span class="str">"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="n"><span class="pln">accuracy</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">KNN</span></span><span class="p"><span class="pun">))</span></span></pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="prettyprint prettyprinted"><span class="pln">          </span><span class="typ">Support</span><span class="pln"> vector machines</span><span class="pun">:</span><span class="pln">
          </span><span class="lit">0.918</span><span class="pln">
          </span><span class="typ">Random</span><span class="pln"> forest</span><span class="pun">:</span><span class="pln">
          </span><span class="lit">0.943</span><span class="pln">
          K</span><span class="pun">-</span><span class="pln">nearest</span><span class="pun">-</span><span class="pln">neighbors</span><span class="pun">:</span><span class="pln">
          </span><span class="lit">0.896</span><span class="pln">

        </span></pre>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Random forest won, right?</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="precision-and-recall">Precision and recall</h3>
<p>Measurements aren't golden formulas which always spit out high numbers for good models and low numbers for bad ones. Inherently they convey something sentiment about a model's performance, and it's the job of the human designer to determine each number's validity. The problem with accuracy is that outcomes aren't necessarily equal. If my classifier predicted a customer would churn and they didn't, that's not the best but it's forgivable. However, if my classifier predicted a customer would return, I didn't act, and then they churned... that's really bad.</p>
<p>I'll be using another built in <code>scikit-learn</code> function to construction a confusion matrix. A confusion matrix is a way of visualizing predictions made by a classifier and is just a table showing the distribution of predictions for a specific class. The x-axis indicates the true class of each observation (if a customer churned or not) while the y-axis corresponds to the class predicted by the model (if my classifier said a customer would churned or not).</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[6]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">metrics</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">confusion_matrix</span></span><span class="pln">

</span><span class="n"><span class="pln">y</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">array</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">class_names</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">unique</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="n"><span class="pln">confusion_matrices</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">[</span></span><span class="pln">
    </span><span class="p"><span class="pun">(</span></span><span class="pln"> </span><span class="s"><span class="str">"Support Vector Machines"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">confusion_matrix</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">SVC</span></span><span class="p"><span class="pun">))</span></span><span class="pln"> </span><span class="p"><span class="pun">),</span></span><span class="pln">
    </span><span class="p"><span class="pun">(</span></span><span class="pln"> </span><span class="s"><span class="str">"Random Forest"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">confusion_matrix</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">RF</span></span><span class="p"><span class="pun">))</span></span><span class="pln"> </span><span class="p"><span class="pun">),</span></span><span class="pln">
    </span><span class="p"><span class="pun">(</span></span><span class="pln"> </span><span class="s"><span class="str">"K-Nearest-Neighbors"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">confusion_matrix</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">run_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">KNN</span></span><span class="p"><span class="pun">))</span></span><span class="pln"> </span><span class="p"><span class="pun">),</span></span><span class="pln">
</span><span class="p"><span class="pun">]</span></span><span class="pln">

</span><span class="c"><span class="com"># Pyplot code not included to reduce clutter</span></span><span class="pln">
</span><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">churn_display</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">draw_confusion_matrices</span></span><span class="pln">
</span><span class="o"><span class="pun">%</span></span><span class="k"><span class="pln">matplotlib</span></span><span class="pln"> </span><span class="n"><span class="kwd">inline</span></span><span class="pln">

</span><span class="n"><span class="pln">draw_confusion_matrices</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">confusion_matrices</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">class_names</span></span><span class="p"><span class="pun">)</span></span>
</pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="./ŷhat _ Predicting customer churn with scikit-learn_files/charts.png">
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>An important question to ask might be, <em>When an individual churns, how often does my classifier predict that correctly?</em> This measurement is called "recall" and a quick look at these diagrams can demonstrate that random forest is clearly best for this criteria. Out of all the churn cases (outcome "<code>1</code>") random forest correctly retrieved 330 out of 482. This translates to a churn "recall" of about <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;68&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 2.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.839em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1001.79em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">68</span><span class="mi" id="MathJax-Span-4" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>68</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-1">68\%</script></span> (<span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;330&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;482&lt;/mn&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;/&lt;/mo&gt;&lt;/mrow&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-5" style="width: 7.843em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.319em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1006.27em 2.78em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-6"><span class="mn" id="MathJax-Span-7" style="font-family: MathJax_Main;">330</span><span class="texatom" id="MathJax-Span-8"><span class="mrow" id="MathJax-Span-9"><span class="mo" id="MathJax-Span-10" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main;">482</span><span class="mo" id="MathJax-Span-12" style="font-family: MathJax_Main; padding-left: 0.271em;">≈</span><span class="mn" id="MathJax-Span-13" style="font-family: MathJax_Main; padding-left: 0.271em;">2</span><span class="texatom" id="MathJax-Span-14"><span class="mrow" id="MathJax-Span-15"><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main;">/</span></span></span><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.386em; border-left: 0px solid; width: 0px; height: 1.336em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>330</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>482</mn><mo>≈</mo><mn>2</mn><mrow class="MJX-TeXAtom-ORD"><mo>/</mo></mrow><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">330 / 482 \approx 2/3</script></span>), far better than support vector machines (<span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;50&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-18" style="width: 3.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.87em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1002.83em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-19"><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">≈</span><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.271em;">50</span><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≈</mo><mn>50</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\approx 50\%</script></span>) or k-nearest-neighbors (<span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2248;&lt;/mo&gt;&lt;mn&gt;35&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 3.586em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.87em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1002.83em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">≈</span><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.271em;">35</span><span class="mi" id="MathJax-Span-27" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>≈</mo><mn>35</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-4">\approx 35\%</script></span>).</p>
<p>Another question of importance is "precision" or, <em>When a classifier predicts an individual will churn, how often does that individual actually churn?</em> The differences in semantic are small from the previous question, but it makes quite a different. Random forest again out preforms the other two at about <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;93&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-28" style="width: 2.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.839em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1001.79em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-29"><span class="mn" id="MathJax-Span-30" style="font-family: MathJax_Main;">93</span><span class="mi" id="MathJax-Span-31" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>93</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-5">93\%</script></span> precision (330 out of 356) with support vector machines a little behind at about <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;87&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 2.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.839em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1001.79em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="mn" id="MathJax-Span-34" style="font-family: MathJax_Main;">87</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>87</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">87\%</script></span> (235 out of 269). K-nearest-neighbors lags at about <span class="math"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;80&lt;/mn&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x0025;&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-36" style="width: 2.287em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.839em; height: 0px; font-size: 124%;"><span style="position: absolute; clip: rect(1.481em 1001.79em 2.556em -999.998em); top: -2.372em; left: 0em;"><span class="mrow" id="MathJax-Span-37"><span class="mn" id="MathJax-Span-38" style="font-family: MathJax_Main;">80</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Main;">%</span></span><span style="display: inline-block; width: 0px; height: 2.377em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.108em; border-left: 0px solid; width: 0px; height: 1.114em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>80</mn><mi mathvariant="normal">%</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">80\%</script></span>.</p>
<p>While, just like accuracy, precision and recall still rank random forest above SVC and KNN, this won't always be true. When different measurements do return a different pecking order, understanding the values and trade-offs of each rating should effect how you proceed.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="thinking-in-probabilities">Thinking in Probabilities</h3>
<p>Decision making often favors probability over simple classifications. There's plainly more information in statements like <em>"there's a 20% chance of rain tomorrow"</em> and <em>"about 55% of test takers pass the California bar exam"</em> than just saying <em>"it shouldn't rain tomorrow"</em> or <em>"you'll probably pass."</em> Probability predictions for churn also allow us to gauge a customers expected value, and their expected loss. Who do you want to reach out to first, the client with a 80% churn risk who pays <span>$</span>20,000 annually, or the client who's worth <span>$</span>100,000 a year with a 40% risk? How much should you spend on each client?</p>
<p>While I'm moving a bit away from my expertise, being able to ask that question requires producing predictions a little differently. However, <code>scikit-learn</code> makes moving to probabilities easy; my three models have <code>predict_proba()</code> built right into their class objects. This is the same cross validation code with only a few lines changed.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[7]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="k"><span class="kwd">def</span></span><span class="pln"> </span><span class="nf"><span class="pln">run_prob_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">clf_class</span></span><span class="p"><span class="pun">,</span></span><span class="o"><span class="pln"> </span><span class="pun">**</span></span><span class="n"><span class="pln">kwargs</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
    </span><span class="n"><span class="pln">kf</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="typ">KFold</span></span><span class="p"><span class="pun">(</span></span><span class="nb"><span class="pln">len</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">),</span></span><span class="n"><span class="pln"> n_folds</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">5</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">shuffle</span></span><span class="o"><span class="pun">=</span></span><span class="bp"><span class="kwd">True</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
    </span><span class="n"><span class="pln">y_prob</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">zeros</span></span><span class="p"><span class="pun">((</span></span><span class="nb"><span class="pln">len</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">),</span></span><span class="mi"><span class="lit">2</span></span><span class="p"><span class="pun">))</span></span><span class="pln">
    </span><span class="k"><span class="kwd">for</span></span><span class="pln"> </span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">test_index</span></span><span class="pln"> </span><span class="ow"><span class="kwd">in</span></span><span class="pln"> </span><span class="n"><span class="pln">kf</span></span><span class="p"><span class="pun">:</span></span><span class="pln">
        </span><span class="n"><span class="pln">X_train</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">X_test</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">],</span></span><span class="pln"> </span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">test_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="n"><span class="pln">y_train</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="n"><span class="pln">clf</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">clf_class</span></span><span class="p"><span class="pun">(</span></span><span class="o"><span class="pun">**</span></span><span class="n"><span class="pln">kwargs</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">fit</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X_train</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y_train</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="c"><span class="com"># Predict probabilities, not classes</span></span><span class="pln">
        </span><span class="n"><span class="pln">y_prob</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">test_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">predict_proba</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X_test</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
    </span><span class="k"><span class="kwd">return</span></span><span class="pln"> </span><span class="n"><span class="pln">y_prob</span></span><span class="pln">
      </span></pre></div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="how-good-is-good">How good is good?</h3>
<p>Determining how good a predictor which gives <em>probabilities</em> rather than <em>classes</em> is a bit more difficult. If I predict there's a 20% likelihood of rain tomorrow I don't get to live out all the possible outcomes of the universe. It either rains or it doesn't.</p>
<p>What helps is that the predictors aren't making one prediction, they're making 3000+. So for every time I predict an event to occur 20% of the time I can see how often those events actually happen. Here's I use <code>pandas</code> to help me compare the predictions made by random forest against the actual outcomes.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[8]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="nn"><span class="pln">warnings</span></span><span class="pln">
</span><span class="n"><span class="pln">warnings</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">filterwarnings</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">'ignore'</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># Use 10 estimators so predictions are all multiples of 0.1</span></span><span class="pln">
</span><span class="n"><span class="pln">pred_prob</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">run_prob_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">RF</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">n_estimators</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">10</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">pred_churn</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pred_prob</span></span><span class="p"><span class="pun">[:,</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">is_churn</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">y</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="mi"><span class="lit">1</span></span><span class="pln">

</span><span class="c"><span class="com"># Number of times a predicted probability is assigned to an observation</span></span><span class="pln">
</span><span class="n"><span class="pln">counts</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">value_counts</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">pred_churn</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># calculate true probabilities</span></span><span class="pln">
</span><span class="n"><span class="pln">true_prob</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">{}</span></span><span class="pln">
</span><span class="k"><span class="kwd">for</span></span><span class="pln"> </span><span class="n"><span class="pln">prob</span></span><span class="pln"> </span><span class="ow"><span class="kwd">in</span></span><span class="pln"> </span><span class="n"><span class="pln">counts</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">index</span></span><span class="p"><span class="pun">:</span></span><span class="pln">
    </span><span class="n"><span class="pln">true_prob</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">prob</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">mean</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">is_churn</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">pred_churn</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="n"><span class="pln">prob</span></span><span class="p"><span class="pun">])</span></span><span class="pln">
    </span><span class="n"><span class="pln">true_prob</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="typ">Series</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">true_prob</span></span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="c"><span class="com"># pandas-fu</span></span><span class="pln">
</span><span class="n"><span class="pln">counts</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">concat</span></span><span class="p"><span class="pun">([</span></span><span class="n"><span class="pln">counts</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">true_prob</span></span><span class="p"><span class="pun">],</span><span class="pln"> </span></span><span class="n"><span class="pln">axis</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">)</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">reset_index</span></span><span class="p"><span class="pun">()</span></span><span class="pln">
</span><span class="n"><span class="pln">counts</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">columns</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'pred_prob'</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="s"><span class="str">'count'</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="s"><span class="str">'true_prob'</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">counts</span></span>
</pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt output_prompt col-sm-1">
        Out[8]:</div>
<div class="box-flex1 output_subarea output_pyout col-sm-11">
<div class="output_html rendered_html">
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th></th>
<th>pred_prob</th>
<th>count</th>
<th>true_prob</th>
</tr>
</thead>
<tbody>
<tr>
<th>0 </th>
<td> 0.0</td>
<td> 1765</td>
<td> 0.028329</td>
</tr>
<tr>
<th>1 </th>
<td> 0.1</td>
<td>  693</td>
<td> 0.025974</td>
</tr>
<tr>
<th>2 </th>
<td> 0.2</td>
<td>  269</td>
<td> 0.070632</td>
</tr>
<tr>
<th>3 </th>
<td> 0.3</td>
<td>  123</td>
<td> 0.138211</td>
</tr>
<tr>
<th>4 </th>
<td> 0.4</td>
<td>   77</td>
<td> 0.350649</td>
</tr>
<tr>
<th>5 </th>
<td> 0.5</td>
<td>   54</td>
<td> 0.518519</td>
</tr>
<tr>
<th>6 </th>
<td> 0.6</td>
<td>   73</td>
<td> 0.835616</td>
</tr>
<tr>
<th>7 </th>
<td> 0.7</td>
<td>   76</td>
<td> 0.855263</td>
</tr>
<tr>
<th>8 </th>
<td> 0.8</td>
<td>   70</td>
<td> 0.957143</td>
</tr>
<tr>
<th>9 </th>
<td> 0.9</td>
<td>   75</td>
<td> 0.973333</td>
</tr>
<tr>
<th>10</th>
<td> 1.0</td>
<td>   58</td>
<td> 1.000000</td>
</tr>
</tbody>
</table>
<p>11 rows × 3 columns</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see that random forests predicted that 75 individuals would have a 0.9 probability of churn and in actuality that group had a ~0.97 rate.</p>
<h3 id="calibration-and-descrimination">Calibration and Discrimination</h3>
<p>Using the <code>DataFrame</code> above I can draw a pretty simple graph to help visualize probability measurements. The x axis represents the churn probabilities which random forest assigned to a group of individuals. The y axis is the actual rate of churn within that group, and each point is scaled relative to the size of the group.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[9]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">ggplot</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="o"><span class="pun">*</span></span><span class="pln">
</span><span class="o"><span class="pun">%</span></span><span class="k"><span class="pln">matplotlib</span></span><span class="pln"> </span><span class="n"><span class="kwd">inline</span></span><span class="pln">

</span><span class="n"><span class="pln">baseline</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">np</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">mean</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">is_churn</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">ggplot</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">counts</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">aes</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">x</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'pred_prob'</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'true_prob'</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">size</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'count'</span></span><span class="p"><span class="pun">))</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">geom_point</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">color</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'blue'</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">stat_function</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">fun</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="k"><span class="kwd">lambda</span></span><span class="pln"> </span><span class="n"><span class="pln">x</span></span><span class="p"><span class="pun">:</span></span><span class="pln"> </span><span class="n"><span class="pln">x</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">color</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'red'</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">stat_function</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">fun</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="k"><span class="kwd">lambda</span></span><span class="pln"> </span><span class="n"><span class="pln">x</span></span><span class="p"><span class="pun">:</span></span><span class="pln"> </span><span class="n"><span class="pln">baseline</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">color</span></span><span class="o"><span class="pun">=</span></span><span class="s"><span class="str">'green'</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">xlim</span></span><span class="p"><span class="pun">(</span></span><span class="o"><span class="pun">-</span><span class="mo"><span class="lit">0</span></span><span class="lit">.</span></span><span class="mo"><span class="lit">05</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="mf"><span class="pln"> </span><span class="lit">1.05</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> </span><span class="n"><span class="pln">ylim</span></span><span class="p"><span class="pun">(</span></span><span class="o"><span class="pun">-</span><span class="mo"><span class="lit">0</span></span><span class="lit">.</span></span><span class="mo"><span class="lit">05</span></span><span class="p"><span class="pun">,</span></span><span class="mf"><span class="lit">1.05</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">ggtitle</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"Random Forest"</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> \
    </span><span class="n"><span class="pln">xlab</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"Predicted probability"</span></span><span class="p"><span class="pun">)</span></span><span class="pln"> </span><span class="o"><span class="pun">+</span></span><span class="pln"> </span><span class="n"><span class="pln">ylab</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"Relative frequency of outcome"</span></span><span class="p"><span class="pun">)</span></span>
</pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_display_data">
<img src="./ŷhat _ Predicting customer churn with scikit-learn_files/ggplot.png" style="width:90%; height:auto; max-height:1000px;">
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>You may have also noticed the two lines I drew with <code>stat_function()</code>.</p>
<p>The red line represents a perfect prediction for a given group, or when the churn probability forecasted equals the outcome frequency. The green line shows the baseline probability of churn. For this dataset it's about 0.15.</p>
<p>Calibration is a relatively simple measurement and can be summed up as so: <em>Events predicted to happen 60% of the time should happen 60% of the time.</em> For all individuals I predict to have a churn risk of between 30 and 40%, the true churn rate for that group should be about 35%. For the graph above think of it as, <em>How close are my predictions to the red line?</em></p>
<p>Discrimination measures <em>How far are my predictions away from the green line?</em> Why is that important?</p>
<p>Well, if I assign a churn probability of 15% to every individual I'll have near perfect calibration due to averages, but I'll be lacking any real insight. Discrimination gives a model a better score if it's able to isolate groups which are further from the base set.</p>
<p><code>Scikit-learn</code> doesn't come with these measurements, meaning I've had to implement them myself. For everyone's sake I've kept the math and source code out of this blog. Equations are replicated from <a href="https://www.google.com/search?q=Measures+of+Discrimination+Skill+in+Probabilistic+Judgment&amp;oq=Measures+of+Discrimination+Skill+in+Probabilistic+Judgment" target="_blank">Yang, Yates, and Smith (1991)</a> and the code I wrote in the <code>churn_measurements</code> import below can be found on GitHub <a href="https://github.com/EricChiang/churn/blob/master/churn_measurements.py" target="_blank">here</a>.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[10]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">churn_measurements</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">calibration</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">discrimination</span></span></pre></div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see how my three models fair on these measurements.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[11]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="k"><span class="kwd">def</span></span><span class="pln"> </span><span class="nf"><span class="pln">print_measurements</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">pred_prob</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
    </span><span class="n"><span class="pln">churn_prob</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">is_churn</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">pred_prob</span></span><span class="p"><span class="pun">[:,</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">],</span></span><span class="pln"> </span><span class="n"><span class="pln">y</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="mi"><span class="lit">1</span></span><span class="pln">
    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"  </span></span><span class="si"><span class="str">%-20s</span></span><span class="s"><span class="str"> </span></span><span class="si"><span class="str">%.4f</span></span><span class="s"><span class="str">"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"Calibration Error"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">calibration</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">churn_prob</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">is_churn</span></span><span class="p"><span class="pun">))</span></span><span class="pln">
    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"  </span></span><span class="si"><span class="str">%-20s</span></span><span class="s"><span class="str"> </span></span><span class="si"><span class="str">%.4f</span></span><span class="s"><span class="str">"</span></span><span class="pln"> </span><span class="o"><span class="pun">%</span></span><span class="pln"> </span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"Discrimination"</span></span><span class="p"><span class="pun">,</span></span><span class="pln"> </span><span class="n"><span class="pln">discrimination</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">churn_prob</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">is_churn</span></span><span class="p"><span class="pun">))</span></span><span class="pln">

    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Note -- Lower calibration is better, higher discrimination is better"</span></span><span class="pln">

    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Support vector machines:"</span></span><span class="pln">
    </span><span class="n"><span class="pln">print_measurements</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">run_prob_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">SVC</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">probability</span></span><span class="o"><span class="pun">=</span></span><span class="bp"><span class="kwd">True</span></span><span class="p"><span class="pun">))</span></span><span class="pln">

    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"Random forests:"</span></span><span class="pln">
    </span><span class="n"><span class="pln">print_measurements</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">run_prob_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">RF</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">n_estimators</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">18</span></span><span class="p"><span class="pun">))</span></span><span class="pln">

    </span><span class="k"><span class="kwd">print</span></span><span class="pln"> </span><span class="s"><span class="str">"K-nearest-neighbors:"</span></span><span class="pln">

</span><span class="n"><span class="pln">print_measurements</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">run_prob_cv</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">KNN</span></span><span class="p"><span class="pun">))</span></span></pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="prettyprint prettyprinted"><span class="pln">          </span><span class="typ">Note</span><span class="pln"> </span><span class="pun">--</span><span class="pln"> </span><span class="typ">Lower</span><span class="pln"> calibration </span><span class="kwd">is</span><span class="pln"> better</span><span class="pun">,</span><span class="pln"> higher discrimination </span><span class="kwd">is</span><span class="pln"> better
          </span><span class="typ">Support</span><span class="pln"> vector machines</span><span class="pun">:</span><span class="pln">
          </span><span class="typ">Calibration</span><span class="pln"> </span><span class="typ">Error</span><span class="pln">    </span><span class="lit">0.0017</span><span class="pln">
          </span><span class="typ">Discrimination</span><span class="pln">       </span><span class="lit">0.0667</span><span class="pln">
          </span><span class="typ">Random</span><span class="pln"> forests</span><span class="pun">:</span><span class="pln">
          </span><span class="typ">Calibration</span><span class="pln"> </span><span class="typ">Error</span><span class="pln">    </span><span class="lit">0.0079</span><span class="pln">
          </span><span class="typ">Discrimination</span><span class="pln">       </span><span class="lit">0.0830</span><span class="pln">
          K</span><span class="pun">-</span><span class="pln">nearest</span><span class="pun">-</span><span class="pln">neighbors</span><span class="pun">:</span><span class="pln">
          </span><span class="typ">Calibration</span><span class="pln"> </span><span class="typ">Error</span><span class="pln">    </span><span class="lit">0.0022</span><span class="pln">
          </span><span class="typ">Discrimination</span><span class="pln">       </span><span class="lit">0.0449</span></pre>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unlike the classification comparisons earlier, random forest isn't as clearly the front-runner here. While it's good at differentiating between high and low probability churn events, it has trouble assigning an accurate probability estimate to those events. For example the group which random forest predicts to have a 30% churn rate actually had a true churn rate of 14%. Clearly there's more work to be done, but I leave that to you as a challenge.</p>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="putting-the-model-to-use-with-yhat">Putting the model to use with Yhat</h3>
<p>Time to upload a model to the cloud! In order to show some cool functionality, I'm going to go ahead and create a test set from the original churn data using <code>test_train_split()</code> from sklearn. From there, I fit a support vector classifier for my deployment.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[12]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">sklearn</span><span class="pun">.</span><span class="pln">cross_validation</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="pln">train_test_split</span></span><span class="pln">

</span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">test_index</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">train_test_split</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">churn_df</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">index</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">clf</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">SVC</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">probability</span></span><span class="o"><span class="pun">=</span></span><span class="bp"><span class="kwd">True</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
</span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">fit</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">],</span></span><span class="n"><span class="pln">y</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">train_index</span></span><span class="p"><span class="pun">])</span></span><span class="pln">

</span><span class="n"><span class="pln">test_churn_df</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_df</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">ix</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">test_index</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
</span><span class="n"><span class="pln">test_churn_df</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">to_csv</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"test_churn.csv"</span></span><span class="p"><span class="pun">)</span></span></pre></div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>The model I'm going to deploy using <code>yhat</code> replicates the pipeline of this blog with a few modifications. Because I already defined variables within my global scope such as <code>yes_no_cols</code>, <code>features</code>, and <code>scaler</code> I can just use them without having to specify them further.</p>
<p>On the methodological side I've added a few calculations. First the customer worth has been added (the sum of the total charges to that individual). Combining this value with probability of churn creates a very important measurement: the expected loss of revenue from that customer. This is where an accurate prediction model plays an important role as it's impossible to produce these values with only classifications.</p>
</div>
<div class="cell border-box-sizing code_cell vbox">
<div class="input hbox row">
<div class="prompt input_prompt col-sm-1">
      In&nbsp;[13]:
    </div>
<div class="input_area col-sm-11 box-flex1">
<div class="highlight"><pre class="prettyprint prettyprinted"><span class="kn"><span class="kwd">from</span></span><span class="pln"> </span><span class="nn"><span class="pln">yhat</span></span><span class="pln"> </span><span class="kn"><span class="kwd">import</span></span><span class="pln"> </span><span class="n"><span class="typ">Yhat</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="typ">YhatModel</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">preprocess</span></span><span class="pln">

</span><span class="k"><span class="kwd">class</span></span><span class="pln"> </span><span class="nc"><span class="typ">ChurnModel</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="typ">YhatModel</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
    </span><span class="c"><span class="com"># Type casts incoming data as a dataframe</span></span><span class="pln">
    </span><span class="nd"><span class="lit">@preprocess</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">in_type</span></span><span class="o"><span class="pun">=</span></span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="typ">DataFrame</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">out_type</span></span><span class="o"><span class="pun">=</span></span><span class="n"><span class="pln">pd</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="typ">DataFrame</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
    </span><span class="k"><span class="kwd">def</span></span><span class="pln"> </span><span class="nf"><span class="pln">execute</span></span><span class="p"><span class="pun">(</span></span><span class="bp"><span class="kwd">self</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">):</span></span><span class="pln">
        </span><span class="c"><span class="com"># Collect customer meta data</span></span><span class="pln">
        </span><span class="n"><span class="pln">response</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">[[</span></span><span class="s"><span class="str">'Area Code'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Phone'</span></span><span class="p"><span class="pun">]]</span></span><span class="pln">
        </span><span class="n"><span class="pln">charges</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'Day Charge'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Eve Charge'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Night Charge'</span></span><span class="p"><span class="pun">,</span></span><span class="s"><span class="str">'Intl Charge'</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="n"><span class="pln">response</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'customer_worth'</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">charges</span></span><span class="p"><span class="pun">]</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">sum</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">axis</span></span><span class="o"><span class="pun">=</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="c"><span class="com"># Convert yes no columns to bool</span></span><span class="pln">
        </span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">yes_no_cols</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">yes_no_cols</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">==</span></span><span class="pln"> </span><span class="s"><span class="str">'yes'</span></span><span class="pln">
        </span><span class="c"><span class="com"># Create feature space</span></span><span class="pln">
        </span><span class="n"><span class="pln">X</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">data</span></span><span class="p"><span class="pun">[</span></span><span class="n"><span class="pln">features</span></span><span class="p"><span class="pun">]</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">as_matrix</span></span><span class="p"><span class="pun">()</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">astype</span></span><span class="p"><span class="pun">(</span></span><span class="nb"><span class="kwd">float</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="n"><span class="pln">X</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">scaler</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">transform</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="c"><span class="com"># Make prediction</span></span><span class="pln">
        </span><span class="n"><span class="pln">churn_prob</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">clf</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">predict_proba</span></span><span class="p"><span class="pun">(</span></span><span class="n"><span class="pln">X</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="n"><span class="pln">response</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'churn_prob'</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">churn_prob</span></span><span class="p"><span class="pun">[:,</span></span><span class="mi"><span class="lit">1</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="c"><span class="com"># Calculate expected loss by churn</span></span><span class="pln">
        </span><span class="n"><span class="pln">response</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'expected_loss'</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">response</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'churn_prob'</span></span><span class="p"><span class="pun">]</span></span><span class="pln"> </span><span class="o"><span class="pun">*</span></span><span class="pln"> </span><span class="n"><span class="pln">response</span></span><span class="p"><span class="pun">[</span></span><span class="s"><span class="str">'customer_worth'</span></span><span class="p"><span class="pun">]</span></span><span class="pln">
        </span><span class="n"><span class="pln">response</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">response</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">sort</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">'expected_loss'</span></span><span class="p"><span class="pun">,</span><span class="pln"> </span></span><span class="n"><span class="pln">ascending</span></span><span class="o"><span class="pun">=</span></span><span class="bp"><span class="kwd">False</span></span><span class="p"><span class="pun">)</span></span><span class="pln">
        </span><span class="c"><span class="com"># Return response DataFrame</span></span><span class="pln">
        </span><span class="k"><span class="kwd">return</span></span><span class="pln"> </span><span class="n"><span class="pln">response</span></span><span class="pln">

</span><span class="n"><span class="pln">yh</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="typ">Yhat</span></span><span class="p"><span class="pun">(</span></span><span class="pln">
    </span><span class="s"><span class="str">"e[at]yhathq.com"</span></span><span class="p"><span class="pun">,</span></span><span class="pln">
    </span><span class="s"><span class="str">"MY API KEY"</span></span><span class="p"><span class="pun">,</span></span><span class="pln">
    </span><span class="s"><span class="str">"http://cloud.yhathq.com/"</span></span><span class="pln">
</span><span class="p"><span class="pun">)</span></span><span class="pln">

</span><span class="n"><span class="pln">response</span></span><span class="pln"> </span><span class="o"><span class="pun">=</span></span><span class="pln"> </span><span class="n"><span class="pln">yh</span></span><span class="o"><span class="pun">.</span></span><span class="n"><span class="pln">deploy</span></span><span class="p"><span class="pun">(</span></span><span class="s"><span class="str">"PythonChurnModel"</span></span><span class="p"><span class="pun">,</span></span><span class="n"><span class="typ">ChurnModel</span></span><span class="p"><span class="pun">,</span></span><span class="nb"><span class="pln">globals</span></span><span class="p"><span class="pun">())</span></span>
</pre></div>
</div>
</div>
<div class="vbox output_wrapper">
<div class="output vbox">
<div class="hbox row output_area"><div class="prompt"></div>
<div class="box-flex1 output_subarea output_stream output_stdout">
<pre class="prettyprint prettyprinted"><span class="pln">          </span><span class="typ">Are</span><span class="pln"> you sure you want to deploy</span><span class="pun">?</span><span class="pln"> </span><span class="pun">(</span><span class="pln">y</span><span class="pun">/</span><span class="pln">N</span><span class="pun">):</span><span class="pln"> y

        </span></pre>
</div>
</div>
</div>
</div>
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="yhat-batch-mode">Yhat batch mode</h3>
<p>There comes a point when data science tools need to stop being scripts on an EC2 instance and start solving problems. In this case, empowering a retention team by warning them about customers likely to churn.</p>
<p>Our <i>M.O.</i> here at Yhat is finding ways to make data science applicable and practical as quickly as possible. Because my <code>execute()</code> function takes and returns a <code>DataFrame</code>, Yhat allows me to invoke my routine through a batch-scoring mode. The concept is simple. Upload a csv file from anywhere, the model pipeline is executed and the user gets a csv file back. This means that my method for scoring customers for churn-risk can be utilized by anyone else at my company regardless of their technical know-how, understanding of machine learning, or technical dependencies like <code>Python</code> or <code>R</code>.</p>
<p>Logging into <a href="http://cloud.yhathq.com/?utm_source=yhathq&amp;utm_medium=blog&amp;utm_content=textlink&amp;utm_campaign=customerchurn" target="_blank">cloud.yhathq.com</a> and selecting my model gives me the following screen. The csv file I uploaded was the training data I created in the last section--in practice, this would be a new file exported from our CRM or customer database in the same format as the one I used to train the model.</p>
<img src="./ŷhat _ Predicting customer churn with scikit-learn_files/cloud.png" style="width:90%; height:auto; max-height:1000px;">
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>Wait a second, download the resulting file at the bottom of the page when it's ready, and open it in Excel.</p>
<img src="./ŷhat _ Predicting customer churn with scikit-learn_files/workbook.png" style="width:90%; height:auto; max-height:1000px;">
</div>
<div class="text_cell_render border-box-sizing rendered_html">
<p>And there you go. Over 800 customers ranked and analyzed via drag and drop.</p>
</div>



        </div>
      </article>
      <div class="col-sm-2 col-sm-offset-1 hidden-sm hidden-xs sidebar-column">
        
  <div class="yhat-desc">
    <a href="https://www.yhat.com/?utm_source=blog">
      <img style="height:2em; display:inline-block;" src="./ŷhat _ Predicting customer churn with scikit-learn_files/logo_white_hat.png">
      <p>
        Yhat allows data scientists to programmatically deploy R
        and Python models into production applications via REST API endpoints.
      </p>
    </a>
  </div>
  <h4 class="top-posts">Top Posts</h4>
  <ul class="top-posts">
  
    
    <li>
      <a href="http://blog.yhat.com/posts/data-science-interviews.html">
        <p>What We Learned Analyzing Hundreds of Data Science Interviews</p>
      </a>
    </li>
    
  
    
    <li>
      <a href="http://blog.yhat.com/posts/predicting-customer-churn-with-sklearn.html">
        <p>Predicting customer churn with scikit-learn</p>
      </a>
    </li>
    
  
    
    <li>
      <a href="http://blog.yhat.com/posts/roc-curves.html">
        <p>ROC Curves in Python and R</p>
      </a>
    </li>
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
</ul>
  <h4 class="top-posts">Most Viewed Posts</h4>
  
    
    <div class="sidebar-item">
      <span>1</span>
      <div class="img-group">
        <a href="http://blog.yhat.com/posts/stock-data-python.html">
          <img src="./ŷhat _ Predicting customer churn with scikit-learn_files/data-frame-rodeo.png">
          <p>An Introduction to Stock Market Data Analysis with Python (Part 1)</p>
        </a>
      </div>
    </div>
    <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>2</span>
      <div class="img-group">
        <a href="http://blog.yhat.com/posts/pandasql-intro.html">
          <img src="./ŷhat _ Predicting customer churn with scikit-learn_files/see-you-later.png">
          <p>pandasql: Make python speak SQL</p>
        </a>
      </div>
    </div>
    <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>3</span>
      <div class="img-group">
        <a href="http://blog.yhat.com/posts/moving-from-r-to-python.html">
          <img src="./ŷhat _ Predicting customer churn with scikit-learn_files/r-to-python.jpg">
          <p>Moving from R to Python: The Libraries You Need to Know</p>
        </a>
      </div>
    </div>
    <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>4</span>
      <a href="http://blog.yhat.com/posts/logistic-regression-and-python.html">Logistic Regression in Python</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>5</span>
      <a href="http://blog.yhat.com/posts/stock-data-python-pt2.html">An Introduction to Stock Market Data Analysis with Python (Part 2)</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>6</span>
      <a href="http://blog.yhat.com/posts/r-lm-summary.html">Fitting &amp; Interpreting Linear Models in R</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>7</span>
      <a href="http://blog.yhat.com/posts/rodeo-2.3.0.html">Rodeo v2.3.0: Ridiculous speed and pop-out plots</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>8</span>
      <a href="http://blog.yhat.com/posts/random-forests-in-python.html">Random Forests in Python</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
    <div class="sidebar-item">
      <span>9</span>
      <a href="http://blog.yhat.com/posts/interactive-apps.html">Brand New! Interactive Data Science Apps</a>
    </div>
      <hr style="margin:15px 0px;">
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  


    </div>
    </div>
  </div>
</section>
<br>
<section class="pagination center-text top">
  <div class="container">
    <div class="row">
      <div class="col-sm-offset-3 col-sm-6">
        <!-- Sharingbutton Yhat -->
        <a class="resp-sharing-button__link" href="https://www.yhat.com/" target="_blank">
          <div class="resp-sharing-button resp-sharing-button--yhat resp-sharing-button--large" style="height: 30px; line-height: 1.9;"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
          </div>Learn More</div>
        </a>

        <!-- Sharingbutton Facebook -->

        <a class="facebook-share resp-sharing-button__link" href="https://facebook.com/sharer/sharer.php?u=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html" target="_blank" aria-label="Facebook">
          <div class="resp-sharing-button resp-sharing-button--facebook resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
              <g>
                <path d="M18.768,7.465H14.5V5.56c0-0.896,0.594-1.105,1.012-1.105s2.988,0,2.988,0V0.513L14.171,0.5C10.244,0.5,9.5,3.438,9.5,5.32 v2.145h-3v4h3c0,5.212,0,12,0,12h5c0,0,0-6.85,0-12h3.851L18.768,7.465z"></path>
              </g>
            </svg>
          </div>Facebook</div>
        </a>

        <!-- Sharingbutton Twitter -->
        <a class="twitter-share resp-sharing-button__link" href="https://twitter.com/intent/tweet/?text=Predicting%20customer%20churn%20with%20scikit-learn&amp;url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;via=YhatHQ" target="_blank" aria-label="Twitter">
          <div class="resp-sharing-button resp-sharing-button--twitter resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
              <g>
                <path d="M23.444,4.834c-0.814,0.363-1.5,0.375-2.228,0.016c0.938-0.562,0.981-0.957,1.32-2.019c-0.878,0.521-1.851,0.9-2.886,1.104 C18.823,3.053,17.642,2.5,16.335,2.5c-2.51,0-4.544,2.036-4.544,4.544c0,0.356,0.04,0.703,0.117,1.036 C8.132,7.891,4.783,6.082,2.542,3.332C2.151,4.003,1.927,4.784,1.927,5.617c0,1.577,0.803,2.967,2.021,3.782 C3.203,9.375,2.503,9.171,1.891,8.831C1.89,8.85,1.89,8.868,1.89,8.888c0,2.202,1.566,4.038,3.646,4.456 c-0.666,0.181-1.368,0.209-2.053,0.079c0.579,1.804,2.257,3.118,4.245,3.155C5.783,18.102,3.372,18.737,1,18.459 C3.012,19.748,5.399,20.5,7.966,20.5c8.358,0,12.928-6.924,12.928-12.929c0-0.198-0.003-0.393-0.012-0.588 C21.769,6.343,22.835,5.746,23.444,4.834z"></path>
              </g>
            </svg>
          </div>Twitter</div>
        </a>

        <!-- Sharingbutton Linkedin -->
        <a class="linkedin-share resp-sharing-button__link" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;title=Predicting%20customer%20churn%20with%20scikit-learn&amp;summary=Using%20machine%20learning%20to%20predict%20which%20customers%20are%20likely%20to%20churn.&amp;source=Yhat;" target="_blank" aria-label="Linkedin">
          <div class="resp-sharing-button resp-sharing-button--linkedin resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
              <g>
                <path d="M6.527,21.5h-5v-13h5V21.5z M4.018,6.5H3.988C2.478,6.5,1.5,5.318,1.5,4.019c0-1.329,1.008-2.412,2.547-2.412 c1.541,0,2.488,1.118,2.519,2.447C6.565,5.354,5.588,6.5,4.018,6.5z M15.527,12.5c-1.105,0-2,0.896-2,2v7h-5c0,0,0.059-12,0-13h5 v1.485c0,0,1.548-1.443,3.938-1.443c2.962,0,5.062,2.144,5.062,6.304V21.5h-5v-7C17.527,13.396,16.632,12.5,15.527,12.5z"></path>
              </g>
            </svg>
          </div>Linkedin</div>
        </a>

        <!-- Sharingbutton Reddit -->
        <a class="reddit-share resp-sharing-button__link" href="https://reddit.com/submit/?url=http%3A%2F%2Fblog.yhathq.com%2Fposts%2Fpredicting-customer-churn-with-sklearn.html&amp;title=Predicting%20customer%20churn%20with%20scikit-learn" target="_blank" aria-label="Reddit">
          <div class="resp-sharing-button resp-sharing-button--reddit resp-sharing-button--large"><div aria-hidden="true" class="resp-sharing-button__icon resp-sharing-button__icon--solid">
            <svg version="1.1" x="0px" y="0px" width="24px" height="24px" viewBox="0 0 24 24" enable-background="new 0 0 24 24" xml:space="preserve">
              <path d="M24,11.5c0-1.654-1.346-3-3-3c-0.964,0-1.863,0.476-2.422,1.241c-1.639-1.006-3.747-1.64-6.064-1.723 c0.064-1.11,0.4-3.049,1.508-3.686c0.72-0.414,1.733-0.249,3.01,0.478C17.189,6.317,18.452,7.5,20,7.5c1.654,0,3-1.346,3-3 s-1.346-3-3-3c-1.382,0-2.536,0.944-2.883,2.217C15.688,3,14.479,2.915,13.521,3.466c-1.642,0.945-1.951,3.477-2.008,4.551 C9.186,8.096,7.067,8.731,5.422,9.741C4.863,8.976,3.964,8.5,3,8.5c-1.654,0-3,1.346-3,3c0,1.319,0.836,2.443,2.047,2.844 C2.019,14.56,2,14.778,2,15c0,3.86,4.486,7,10,7s10-3.14,10-7c0-0.222-0.019-0.441-0.048-0.658C23.148,13.938,24,12.795,24,11.5z  M2.286,13.366C1.522,13.077,1,12.351,1,11.5c0-1.103,0.897-2,2-2c0.635,0,1.217,0.318,1.59,0.816 C3.488,11.17,2.683,12.211,2.286,13.366z M6,13.5c0-1.103,0.897-2,2-2s2,0.897,2,2c0,1.103-0.897,2-2,2S6,14.603,6,13.5z  M15.787,18.314c-1.063,0.612-2.407,0.949-3.787,0.949c-1.387,0-2.737-0.34-3.803-0.958c-0.239-0.139-0.321-0.444-0.182-0.683 c0.139-0.24,0.444-0.322,0.683-0.182c1.828,1.059,4.758,1.062,6.59,0.008c0.239-0.138,0.545-0.055,0.683,0.184 C16.108,17.871,16.026,18.177,15.787,18.314z M16,15.5c-1.103,0-2-0.897-2-2c0-1.103,0.897-2,2-2s2,0.897,2,2 C18,14.603,17.103,15.5,16,15.5z M21.713,13.365c-0.397-1.155-1.201-2.195-2.303-3.048C19.784,9.818,20.366,9.5,21,9.5 c1.103,0,2,0.897,2,2C23,12.335,22.468,13.073,21.713,13.365z"></path>
            </svg>
          </div>Reddit</div>
        </a>

      </div>
    </div>
    <hr>
    <div class="row">
      <center>
        <h4>Our Products</h4>
      </center>
        <div class="col-sm-6">
          <center>
            <a href="https://www.yhat.com/products/rodeo" style="max-width:500px; box-shadow:1px 3px 8px 3px #aaa;">
              <img src="./ŷhat _ Predicting customer churn with scikit-learn_files/rodeo-overview-shot.png" style="max-height: 250px;">
            </a>
            <br>
            <p>
              <strong>Rodeo:</strong> a native Python editor built for doing data science on your desktop.
            </p>
            <a href="https://www.yhat.com/products/rodeo" class="btn btn-primary btn-circle" style="margin-top:10px;">Download it now!</a>
          </center>
        </div>
        <div class="col-sm-6">
          <center>
            <a href="https://www.yhat.com/products/scienceops" style="max-width:500px; box-shadow:1px 3px 8px 3px #aaa;">
              <img src="./ŷhat _ Predicting customer churn with scikit-learn_files/over-the-wall.png" style="max-height: 250px;">
            </a>
            <br>
            <div class="content-box-text">
              <strong>ScienceOps:</strong> deploy predictive models in production applications without IT.
            </div>
            <br>
            <a href="https://www.yhat.com/products/scienceops" class="btn btn-primary btn-circle">Learn More</a>
          </center>
        </div>
      </div>
      <hr>
      <div class="row">
        <div class="col-sm-2">
          <a href="http://www.yhat.com/"><img src="./ŷhat _ Predicting customer churn with scikit-learn_files/yhat_clear_bkg.png"></a>
        </div>
        <div class="col-sm-10">
          <p>Yhat (pronounced Y-hat) provides data science solutions
            that let data scientists deploy and integrate predictive models into
            applications without IT or custom coding.
          </p>
        </div>
      </div>
      <div id="slider">
        <!--call-to-action-->
      </div>
    </div>
  </section>
  <script>
  text = encodeURIComponent(document.getElementById('post-title').innerText)
  summary = "Using machine learning to predict which customers are likely to churn."
  summary = encodeURIComponent(summary);
  url = encodeURIComponent("http://blog.yhathq.com/posts/predicting-customer-churn-with-sklearn.html")
  via = encodeURIComponent("YhatHQ")

  tw = "https://twitter.com/intent/tweet/?text="+text +"&url=" + url + "&via=" + via;
  ln = "https://www.linkedin.com/shareArticle?mini=true&url=" + url + "&title=" + text + "&summary=" +summary + "&source=Yhat;"
  rd = "https://reddit.com/submit/?url=" + url + "&title=" + text
  fb = "https://facebook.com/sharer/sharer.php?u="+url
  // https://www.reddit.com/submit?title=myTitle&text=testing

  var elms1 = document.getElementsByClassName("twitter-share")
  for (var i = 0; i < elms1.length; i++) {
    elms1[i].setAttribute("href",tw);
  }
  var elms2 = document.getElementsByClassName("linkedin-share")
  for (var i = 0; i < elms2.length; i++) {
    elms2[i].setAttribute("href",ln);
  }
  var elms3 = document.getElementsByClassName("reddit-share")
  for (var i = 0; i < elms3.length; i++) {
    elms3[i].setAttribute("href",rd);
  }
  var elms4 = document.getElementsByClassName("facebook-share")
  for (var i = 0; i < elms3.length; i++) {
    elms4[i].setAttribute("href",fb);
  }

  </script>
  
        </div>

        <footer>
    <div class="container">
        <div class="row">
            <nav class="contact-links col-sm-2">
                <h4>Contact Us</h4>
                <a href="mailto:info@yhathq.com" target="_blank">info@yhathq.com</a>
                <a href="tel:7188552107">+1 718 855 2107</a>
                <a href="tel:4915735983455">+49 15735983455</a>
            </nav>
            <nav class="links col-sm-2">
                <h4>Our Products</h4>
                <a id="footer-products-scienceops" href="https://yhat.com/products/scienceops">ScienceOps</a>
                <a id="footer-products-rodeo" href="https://yhat.com/products/rodeo">Rodeo</a>
            </nav>
            <nav class="links col-sm-2">
                <h4>Learn More</h4>
                <a id="footer-company" href="https://yhat.com/company">Company</a>
                <a id="footer-blog" href="http://blog.yhat.com/">Blog</a>
                <a id="footer-jobs" href="https://yhat.com/jobs">Jobs</a>
                <a id="header-blog-rss" href="http://blog.yhat.com/rss.xml">RSS</a>

            </nav>
            <nav class="social  col-sm-3">
                <h4>Newsletter</h4>
                <form class="form subscribe-form" role="form">
                  <div class="form-group">
                    <input type="email" value="" name="EMAIL" class="form-control required email" placeholder="Email Address" required="">
                  </div>
                  <button class="btn blue" type="submit">Get Updates</button>
                </form>
            </nav>
            <nav class="social col-sm-3">
                <h4>Connect With Us</h4>
                <div class="clearfix">
                    <a id="footer-twitter" href="https://twitter.com/YhatHQ" target="_blank"><span class="icon icon-twitter"></span></a>
                    <a id="footer-linkedin" href="http://www.linkedin.com/company/3176802" target="_blank"><span class="icon icon-linkedin"></span></a>
                    <a id="footer-angellist" href="http://angel.co/yhat" target="_blank"><span class="icon icon-angellist"></span></a>
                    <a id="footer-github" href="http://github.com/yhat" target="_blank"><span class="icon icon-github"></span></a>
             </div>
            </nav>
        </div>
        <p class="copy">
            <a href="http://nytm.org/made-in-nyc" target="_blank">Made in New York City</a> <span class="divider">•</span> © 2016 ŷhat
        </p>
    </div>
</footer>


        <script src="./ŷhat _ Predicting customer churn with scikit-learn_files/jquery.min.js.download"></script>
<script>window.jQuery || document.write('<script src="../static/js/lib/jquery.min.js"><\/script>')</script>
<!-- <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> -->
<script type="text/javascript" src="./ŷhat _ Predicting customer churn with scikit-learn_files/MathJax.js.download"></script>
<script type="text/javascript" src="./ŷhat _ Predicting customer churn with scikit-learn_files/TeX-AMS-MML_HTMLorMML.js.download"></script>
<script src="./ŷhat _ Predicting customer churn with scikit-learn_files/yhat-blog.js.download"></script>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-37140626-1', 'auto');  // Replace with your property ID.
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->

<!-- Start Twitter -->
<script src="./ŷhat _ Predicting customer churn with scikit-learn_files/oct.js.download" type="text/javascript"></script>
<script type="text/javascript">
twttr.conversion.trackPid('l4chx');
</script>
<noscript>
&lt;img height="1" width="1" style="display:none;" alt="" src="https://analytics.twitter.com/i/adsct?txn_id=l4chx&amp;p_id=Twitter" /&gt;
</noscript>
<!-- end Twitter -->

<!-- signup modal -->
<script src="./ŷhat _ Predicting customer churn with scikit-learn_files/vex.combined.min.js.download"></script>
<script>vex.defaultOptions.className = 'vex-theme-bottom-right-corner';</script>
<link rel="stylesheet" href="./ŷhat _ Predicting customer churn with scikit-learn_files/vex.css">
<link rel="stylesheet" href="./ŷhat _ Predicting customer churn with scikit-learn_files/vex-theme-bottom-right-corner.css">
<script type="text/javascript">
  function setCookie(cname, cvalue, exdays) {
    var d = new Date();
    d.setTime(d.getTime() + (exdays*24*60*60*1000));
    var expires = "expires="+ d.toUTCString();
    document.cookie = cname + "=" + cvalue + "; " + expires;
  }

  function getCookie(cname) {
    var name = cname + "=";
    var ca = document.cookie.split(';');
    for(var i = 0; i <ca.length; i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') {
            c = c.substring(1);
        }
        if (c.indexOf(name) == 0) {
            return c.substring(name.length,c.length);
        }
    }
    return "";
  }
  setTimeout(function() {
    if (! getCookie("yhat-blog-subscriber")) {
      setCookie("yhat-blog-subscriber", true, 365);
      vex.dialog.open({
        message: 'More great reads, straight to your inbox.\nSubscribe to the Yhat blog to get emailed when we publish a new post!',
        input: "<input name=\"email\" type=\"text\" placeholder=\"Email Address\" required />\n</form>",
        showCloseButton: true,
        buttons: [
          $.extend({}, vex.dialog.buttons.YES, {
            text: 'Subscribe'
          })
        ],
        callback: function(data) {
          if (data === false) {
            return console.log('Cancelled');
          }
          $.ajax({
              type: "POST",
              url: "https://www.yhat.com/lead",
              data: {
                  url: "#blog-blog-modal",
                  emailAddress: data.email,
                  curr_page: window.location.pathname,
              },
              dataType: 'json'
          }).done(function(response) {
            // err, then we're done!
          });
          return;
        }
      });
    }
  }, 15*1000);
</script>
<!-- end signup modal -->

    

<script src="./ŷhat _ Predicting customer churn with scikit-learn_files/adsct" type="text/javascript"></script><div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Main, sans-serif;"></div></div></body></html>